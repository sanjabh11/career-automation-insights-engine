# 0001-9 T1: Unify Gemini model/config

## Description
Centralize Gemini model selection and generationConfig defaults across server components. Introduce env-driven configuration to avoid duplication and ensure consistent behavior:
- GEMINI_MODEL (default: gemini-2.5-flash)
- GEMINI_TEMPERATURE, GEMINI_TOP_K, GEMINI_TOP_P, GEMINI_MAX_OUTPUT_TOKENS

Update both `supabase/lib/GeminiClient.ts` and `supabase/functions/gemini-generate/index.ts` to consume these env vars and merge with per-call overrides.

## Status History
- 2025-08-12T13:52:18+05:30: user_approves (Proposed -> Agreed) by User
- 2025-08-12T13:52:18+05:30: start_work (Agreed -> InProgress) by AI_Agent

## Requirements
- Single source of truth for model name and defaults via env.
- Backward compatible: default remains gemini-2.5-flash unless GEMINI_MODEL is set.
- No client-side key exposure; server-only change.

## Implementation Plan
- Add helpers in `supabase/lib/GeminiClient.ts`:
  - `getEnvModel()`: read GEMINI_MODEL with default.
  - `getEnvGenerationDefaults()`: read env defaults and return a partial config.
- Use the helpers in `GeminiClient.generateContent()`.
- In `supabase/functions/gemini-generate/index.ts`, import the helpers and `generationConfigSchema` to build URL and merged generationConfig.
- Keep per-call overrides (function args) taking precedence over env defaults.

## Test Plan
- Unit: validate env parsing and merging behavior (where feasible).
- Integration: call Edge Function with and without overrides; verify model in URL and effective config.
- Manual: set GEMINI_MODEL=gemini-2.5-pro locally and confirm requests hit the correct endpoint.

## Verification
- Both codepaths (GeminiClient and gemini-generate) send requests to identical model/config under same env.
- No duplicate hardcoded defaults in code remain.

## Files Modified
- `supabase/lib/GeminiClient.ts`
- `supabase/functions/gemini-generate/index.ts`
