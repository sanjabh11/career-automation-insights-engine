# PBI-0001-8 Migrate useGemini server-side

**Back to Task Index**: [Tasks for PBI PBI-0001](./tasks.md)

## Description
Ensure all Gemini usage from the frontend goes through the Supabase Edge Function `gemini-generate`. Update `useGemini` to rely on `GeminiService` which calls the Edge Function, and remove any browser-only key paths or references.

## Status History
- 2025-08-11 | Proposed -> InProgress | Updated `useGemini` comments/usage to reflect server-side invocation; verified no `VITE_GEMINI_API_KEY` usages remain

## Requirements
- No client-side usage of Gemini API keys.
- `useGemini` delegates to `GeminiService.generate()` which talks to Edge Function.
- Remove any mock/fallback client paths.

## Implementation Plan
- Validate `src/services/GeminiService.ts` invokes `supabase.functions.invoke('gemini-generate', ...)`.
- Confirm `src/hooks/useGemini.ts` imports and calls the service only.
- Grep the repo for any `VITE_GEMINI_API_KEY` or direct Gemini REST calls and remove/redirect.

## Test Plan
- Unit: mock `GeminiService.generate` and assert `useGemini.generate` sets/loading/error/data correctly.
- Integration: run a sample prompt end-to-end and validate results are returned.
- Security: browser network trace shows no outbound calls to Google Gemini endpoints, only to Supabase Edge.

## Verification
- No `VITE_GEMINI_API_KEY` or client-side Gemini key usage found in the repo.
- Network calls to Gemini only occur on the server.

## Files Modified
- src/hooks/useGemini.ts (comments/usage)
- src/services/GeminiService.ts (server-side invocation)
