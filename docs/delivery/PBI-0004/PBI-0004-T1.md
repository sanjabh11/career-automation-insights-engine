# PBI-0004-T1 Implement Skill-Gap & Learning-Path Edge Functions

## Description
Implement five Supabase Edge Functions that together power the Skill Gap Planner feature set.

| Function | Purpose |
|-----------|---------|
| `skill-gap-analysis` | Compare user skills to occupation requirements; return gap summary. |
| `personalized-skill-recommendations` | Map gaps to AI-generated skill recommendations stored in `ai_skill_recommendations`. |
| `free-courses` | Query SerpAPI / DuckDuckGo for free or low-cost courses addressing each skill. |
| `learning-path` | Generate sequenced learning plan (Gemini) and persist to `learning_paths` table. |
| `progress-tracking` | Update & fetch progress records stored locally and in DB. |

## Status History
| Timestamp | Event | From | To | Details | User |
|-----------|-------|------|----|---------|------|
| 2025-08-07 | user_approves | Proposed | Agreed | Task created & approved. | User |

## Requirements
1. **Zod validation** for each function's request/response.
2. **GeminiClient** usage where AI output is required.
3. **SerpAPI** integration module with API key stored in Supabase secret.
4. **Database** additions:
   - `learning_paths` (id, user_id, occupation_code, plan JSON, created_at).
5. **Unit tests** covering happy & error paths.

## Implementation Plan
1. Add new table migration for `learning_paths`.
2. Create `supabase/functions/{fn}/index.ts` for each endpoint.
3. Share utility modules in `supabase/lib`.
4. Update CI to deploy functions + run tests.

## Test Plan
- **Unit**: Validate schema. Mock Gemini & SerpAPI.
- **Integration**: End-to-end flow on staging.

## Files Added
- `supabase/functions/skill-gap-analysis/index.ts`
- `supabase/functions/personalized-skill-recommendations/index.ts`
- `supabase/functions/free-courses/index.ts`
- `supabase/functions/learning-path/index.ts`
- `supabase/functions/progress-tracking/index.ts`
- Migration: `supabase/migrations/202508071800_add_learning_paths.sql`
